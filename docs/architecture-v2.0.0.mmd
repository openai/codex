graph TB
    subgraph Client["ğŸ–¥ï¸ Client Layer - Kamui4Dè¶…ãˆ"]
        CLI["CLI (v2.0.0)<br/>ğŸš€ CUDAä¸¦åˆ—åŒ–<br/>âš¡ 100x gitè§£æ"]
        TUI["TUI (v2.0.0)<br/>ğŸ“Š GPUçµ±è¨ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ <br/>ğŸ¨ 120fpså¯è¦–åŒ–"]
        GUI["GUI (v2.0.0)<br/>ğŸ® VR/ARå¯¾å¿œ<br/>ğŸŒŒ 4Då¯è¦–åŒ–<br/>ğŸ’¯ 100k+ã‚³ãƒŸãƒƒãƒˆå¯¾å¿œ"]
        VSCode["VSCode Extension<br/>Blueprint UI<br/>Multi-language"]
        Cursor["Cursor IDE<br/>MCP Integration"]
    end

    subgraph GPU["ğŸ”¥ GPU Acceleration Layer (NEW v2.0.0)"]
        WindowsAI["Windows AI API<br/>DirectML<br/>+30% æœ€é©åŒ–"]
        CUDA["CUDA Runtime<br/>Rust-CUDA (cust)<br/>+1000% ä¸¦åˆ—åŒ–"]
        Hybrid["Hybrid Mode<br/>è‡ªå‹•é¸æŠ<br/>æœ€é€Ÿãƒ‘ã‚¹ä¿è¨¼"]
        KernelDriver["Kernel Driver<br/>Pinned Memory<br/>+40% I/Oé«˜é€ŸåŒ–"]
    end

    subgraph Visualization["ğŸŒŒ Kamui4Dè¶…ãˆGitå¯è¦–åŒ– (NEW v2.0.0)"]
        Git3D["3D Git Graph<br/>120fpsä¿è¨¼<br/>InstancedMesh"]
        Git4D["4D Timeline<br/>æ™‚é–“è»¸çµ±åˆ<br/>100,000ã‚³ãƒŸãƒƒãƒˆå¯¾å¿œ"]
        VRMode["VR Mode<br/>Quest 2 å¯¾å¿œ<br/>Virtual Desktopæœ€é©åŒ–"]
        ARMode["AR Mode<br/>ãƒãƒ³ãƒ‰ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼<br/>MediaPipe"]
    end

    subgraph Orchestration["ğŸ¯ Orchestration Layer"]
        OrchestratorRPC["Orchestrator RPC<br/>16 methods<br/>HMAC-SHA256"]
        ProtocolClient["Protocol Client<br/>TypeScript SDK<br/>React hooks"]
        TaskQueue["Task Queue<br/>Priority-based<br/>Concurrent"]
        LockManager["Lock Manager<br/>.codex/lock.json"]
    end

    subgraph Core["âš™ï¸ Core Runtime (Rust v2.0.0)"]
        CoreEngine["Core Engine<br/>codex-core<br/>GPUçµ±åˆ"]
        Blueprint["Blueprint Mode<br/>3å®Ÿè¡Œæˆ¦ç•¥<br/>äºˆç®—ç®¡ç†"]
        TokenBudget["Token Budget<br/>Thread-safe"]
        AuditLog["Audit Logger<br/>æ§‹é€ åŒ–ãƒ­ã‚°"]
        ProjectDoc["Project Doc<br/>AGENTS.md<br/>å¤šè¨€èªå¯¾å¿œ"]
        WindowsAIIntegration["Windows AI Integration<br/>OSæœ€é©åŒ–"]
        HybridAcceleration["Hybrid Acceleration<br/>Windows AI Ã— CUDA"]
    end

    subgraph Agents["ğŸ¤– Sub-Agent System"]
        Supervisor["Supervisor<br/>5min timeout<br/>3x retry"]
        CodeReviewer["Code Reviewer<br/>8è¨€èªå¯¾å¿œ<br/>JA/EN/ZH/KO/FR/DE/ES/PT"]
        TestGen["Test Generator<br/>80%+ coverage"]
        SecAudit["Security Auditor<br/>OWASP Top 10"]
        DeepResearch["Deep Researcher<br/>Multi-source<br/>Citation"]
        CustomAgent["Custom Agents<br/>YAMLå®šç¾©"]
    end

    subgraph Research["ğŸ” Deep Research Engine"]
        SearchProvider["Search Provider<br/>TTL 1h cache<br/>45x faster"]
        GeminiCLI["Gemini CLI<br/>OAuth 2.0 PKCE<br/>Google Search"]
        DuckDuckGo["DuckDuckGo<br/>Zero-cost<br/>No API key"]
        Citation["Citation Manager<br/>ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°"]
    end

    subgraph MCP["ğŸ”Œ MCP Integration (15+ Servers)"]
        CodexMCP["codex mcp-server<br/>Rustå®Ÿè£…<br/>CUDA toolçµ±åˆ"]
        GeminiMCP["gemini-cli-mcp<br/>Google Search<br/>Gemini 2.5"]
        ChromeMCP["chrome-devtools<br/>ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–"]
        PlaywrightMCP["playwright<br/>E2Eãƒ†ã‚¹ãƒˆ"]
        SequentialMCP["sequential-thinking<br/>CoTæ¨è«–"]
        CUDATool["cuda_execute (NEW)<br/>GPUè¨ˆç®—<br/>MatMul/VecAdd"]
    end

    subgraph Storage["ğŸ’¾ Storage & Config"]
        ConfigTOML["config.toml<br/>ãƒ¢ãƒ‡ãƒ«è¨­å®š<br/>Sandboxè¨­å®š"]
        SessionDB["Session DB<br/>ä¼šè©±å±¥æ­´<br/>Checkpoint"]
        AgentDefs[".codex/agents/<br/>YAMLå®šç¾©"]
        ArtifactArchive["_docs/<br/>å®Ÿè£…ãƒ­ã‚°"]
        BlueprintStore["Blueprint Store<br/>Stateæ°¸ç¶šåŒ–"]
    end

    subgraph Monitoring["ğŸ“Š Monitoring & Telemetry"]
        Telemetry["Telemetry<br/>Privacy-respecting<br/>SHA-256ãƒãƒƒã‚·ãƒ³ã‚°"]
        Webhooks["Webhooks<br/>GitHub/Slack/HTTP<br/>HMAC-SHA256"]
        GPUMonitor["GPU Monitor (NEW)<br/>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆ<br/>Windows AI / CUDA"]
    end

    subgraph External["ğŸŒ External Integrations"]
        GitHub["GitHub API<br/>PRè‡ªå‹•åŒ–"]
        Slack["Slack Webhooks<br/>é€šçŸ¥"]
        CustomWebhook["Custom Webhooks<br/>HTTP POST"]
        AudioNotif["Audio Notifications<br/>marisa_owattaze.wav<br/>å®Œäº†é€šçŸ¥"]
    end

    subgraph LLM["ğŸ¤– LLM Providers"]
        OpenAI["OpenAI<br/>GPT-5-codex<br/>Primary"]
        Gemini["Google Gemini<br/>2.5 Pro/Flash<br/>Search grounding"]
        Anthropic["Anthropic<br/>Claude 3.5+<br/>Alternative"]
        Local["Local/Ollama<br/>Llama<br/>Privacy-first"]
    end

    %% Client connections
    CLI --> OrchestratorRPC
    TUI --> OrchestratorRPC
    GUI --> Visualization
    VSCode --> OrchestratorRPC
    Cursor --> CodexMCP
    
    %% GPU Layer connections (NEW)
    CLI --> GPU
    TUI --> GPU
    GUI --> GPU
    CoreEngine --> HybridAcceleration
    HybridAcceleration --> WindowsAI
    HybridAcceleration --> CUDA
    HybridAcceleration --> Hybrid
    WindowsAI --> KernelDriver
    CUDA --> KernelDriver
    
    %% Visualization connections (NEW)
    Visualization --> GPU
    Git3D --> CUDA
    Git4D --> CUDA
    VRMode --> WindowsAI
    ARMode --> WindowsAI
    
    %% Orchestration
    ProtocolClient --> OrchestratorRPC
    OrchestratorRPC --> TaskQueue
    OrchestratorRPC --> LockManager
    TaskQueue --> CoreEngine
    
    %% Core
    CoreEngine --> Blueprint
    CoreEngine --> TokenBudget
    CoreEngine --> AuditLog
    CoreEngine --> Supervisor
    CoreEngine --> ProjectDoc
    CoreEngine --> WindowsAIIntegration
    
    %% Agents
    ProjectDoc --> CodeReviewer
    Supervisor --> CodeReviewer
    Supervisor --> TestGen
    Supervisor --> SecAudit
    Supervisor --> DeepResearch
    Supervisor --> CustomAgent
    
    %% Research
    DeepResearch --> SearchProvider
    SearchProvider --> GeminiCLI
    SearchProvider --> DuckDuckGo
    SearchProvider --> Citation
    
    %% MCP
    CoreEngine --> CodexMCP
    CodexMCP --> GeminiMCP
    CodexMCP --> ChromeMCP
    CodexMCP --> PlaywrightMCP
    CodexMCP --> SequentialMCP
    CodexMCP --> CUDATool
    CUDATool --> CUDA
    
    %% Storage
    CoreEngine --> ConfigTOML
    CoreEngine --> SessionDB
    Supervisor --> AgentDefs
    CoreEngine --> ArtifactArchive
    Blueprint --> BlueprintStore
    
    %% Monitoring (Enhanced)
    CoreEngine --> Telemetry
    CoreEngine --> Webhooks
    CoreEngine --> GPUMonitor
    GPUMonitor --> WindowsAI
    GPUMonitor --> CUDA
    Telemetry --> GitHub
    Webhooks --> Slack
    Webhooks --> CustomWebhook
    Supervisor --> AudioNotif
    
    %% External
    CoreEngine --> GitHub
    CoreEngine --> Slack
    CoreEngine --> CustomWebhook
    
    %% LLM
    CoreEngine --> OpenAI
    GeminiCLI --> Gemini
    CoreEngine --> Anthropic
    CoreEngine --> Local

    %% Styling
    classDef clientClass fill:#e1f5ff,stroke:#01579b,stroke-width:3px
    classDef gpuClass fill:#ffeb3b,stroke:#f57f00,stroke-width:4px
    classDef vizClass fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px
    classDef orchClass fill:#fff9c4,stroke:#f57f17,stroke-width:3px
    classDef coreClass fill:#ffebee,stroke:#c62828,stroke-width:3px
    classDef agentClass fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef researchClass fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    classDef mcpClass fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef storageClass fill:#e0f2f1,stroke:#004d40,stroke-width:2px
    classDef monitoringClass fill:#f1f8e9,stroke:#558b2f,stroke-width:3px
    classDef externalClass fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef llmClass fill:#ede7f6,stroke:#311b92,stroke-width:2px

    class CLI,TUI,GUI,VSCode,Cursor clientClass
    class WindowsAI,CUDA,Hybrid,KernelDriver gpuClass
    class Git3D,Git4D,VRMode,ARMode vizClass
    class OrchestratorRPC,ProtocolClient,TaskQueue,LockManager orchClass
    class CoreEngine,Blueprint,TokenBudget,AuditLog,ProjectDoc,WindowsAIIntegration,HybridAcceleration coreClass
    class Supervisor,CodeReviewer,TestGen,SecAudit,DeepResearch,CustomAgent agentClass
    class SearchProvider,GeminiCLI,DuckDuckGo,Citation researchClass
    class CodexMCP,GeminiMCP,ChromeMCP,PlaywrightMCP,SequentialMCP,CUDATool mcpClass
    class ConfigTOML,SessionDB,AgentDefs,ArtifactArchive,BlueprintStore storageClass
    class Telemetry,Webhooks,GPUMonitor monitoringClass
    class GitHub,Slack,CustomWebhook,AudioNotif externalClass
    class OpenAI,Gemini,Anthropic,Local llmClass




































