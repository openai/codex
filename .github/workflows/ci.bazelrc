common --remote_download_minimal
common --nobuild_runfile_links
common --keep_going

# By default runfiles directories are disabled on Windows but we
# don't read runfiles manifests, so force them on.
common --enable_runfiles

# Rearrange caches on Windows so they're on the same volume as the checkout.
common:windows --disk_cache=D:/a/.cache/bazel-disk-cache
common:windows --repo_contents_cache=D:/a/.cache/bazel-repo-contents-cache
common:windows --repository_cache=D:/a/.cache/bazel-repo-cache

# We prefer to run the build actions entirely remotely so we can dial up the concurrency.
# We have platform-specific tests, so we want to execute the tests on all platforms using the strongest sandboxing available on each platform.

# On linux, we can do a full remote build/test, by targeting the right (x86/arm) runners, so we have coverage of both.
# Linux crossbuilds don't work until we untangle the libc constraint mess.
common:linux --config=remote
common:linux --strategy=remote
common:linux --platforms=//:rbe

# On mac, we can run all the build actions remotely but test actions locally.
common:macos --config=remote
common:macos --strategy=remote
common:macos --strategy=TestRunner=darwin-sandbox,local

common:windows --strategy=TestRunner=local

