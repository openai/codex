# 🔒 Codex環境変数設定テンプレート
# バージョン: v0.56.0-zapabob
# 作成日: 2025-11-02
# 
# 使用方法:
#   1. このファイルをプロジェクトルートに .env としてコピー
#      PowerShell: Copy-Item zapabob\templates\env.template .env
#      Bash: cp zapabob/templates/env.template .env
#   2. 各APIキーの値を実際の値に置き換える
#   3. パーミッション設定（Linux/macOS）: chmod 600 .env
#
# 注意事項:
#   - .envファイルは.gitignoreに追加されており、Gitにコミットされません
#   - APIキーは絶対に公開しないでください
#   - 定期的にAPIキーをローテーションしてください

# ==================== 必須設定 ====================

# OpenAI APIキー（Codex専用、最優先）
# 取得先: https://platform.openai.com/api-keys
# 形式: sk-proj-XXXXXXXXXXXXXXXXXXXX
# 優先度: 🥇 最優先（環境変数の中で最も優先される）
CODEX_API_KEY=

# OpenAI APIキー（汎用、CODEX_API_KEY未設定時のフォールバック）
# 取得先: https://platform.openai.com/api-keys
# 形式: sk-proj-XXXXXXXXXXXXXXXXXXXX
# 優先度: 🥉 フォールバック
OPENAI_API_KEY=

# ==================== MCP Server用APIキー（任意） ====================

# GitHub Personal Access Token（GitHub MCP Server用）
# 取得先: https://github.com/settings/tokens
# 必要なスコープ: repo, read:user
# 形式: ghp_XXXXXXXXXXXXXXXXXXXX
# 用途: PR/Issue管理、コード検索
GITHUB_TOKEN=

# Google Gemini APIキー（Gemini MCP Server用）
# 取得先: https://aistudio.google.com/app/apikey
# 形式: AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXX
# 用途: Google AI、Google Search Grounding
GEMINI_API_KEY=

# Google AI Studio APIキー（GEMINI_API_KEYの代替）
# 取得先: https://aistudio.google.com/app/apikey
# 形式: AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXX
# 優先度: GEMINI_API_KEYが優先される
# GOOGLE_AI_STUDIO_API_KEY=

# Brave Search APIキー（Brave Search MCP Server用）
# 取得先: https://brave.com/search/api/
# 形式: BSA_XXXXXXXXXXXXXXXXXXXX
# 用途: Web検索、コンテンツ取得
# 注意: config.tomlの[mcp_servers.brave-search]セクションでdisabled=trueを削除する必要があります
BRAVE_API_KEY=

# ==================== 通知・連携用（任意） ====================

# Slack Webhook URL（Codex通知用）
# 取得先: https://api.slack.com/messaging/webhooks
# 形式: https://hooks.slack.com/services/XXX/XXX/XXX
# 用途: タスク完了通知、エラー通知
SLACK_WEBHOOK_URL=

# ==================== Google Cloud / Vertex AI（任意） ====================

# Google Cloud Project ID（Vertex AI使用時）
# 取得先: https://console.cloud.google.com/
# 形式: my-project-id
# GCP_PROJECT_ID=

# Vertex AIリージョン（デフォルト: us-central1）
# 選択肢: us-central1, europe-west1, asia-northeast1
# VERTEX_REGION=us-central1

# Google OAuth Client ID（OAuth認証使用時）
# 取得先: https://console.cloud.google.com/apis/credentials
# 形式: XXXXXXXXXX-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.apps.googleusercontent.com
# GOOGLE_OAUTH_CLIENT_ID=

# ==================== Upstash Context7（任意） ====================

# Upstash Redis REST URL
# 取得先: https://console.upstash.com/
# 形式: https://XXXXXXXX.upstash.io
# UPSTASH_REDIS_REST_URL=

# Upstash Redis REST Token
# 取得先: https://console.upstash.com/
# 形式: AXXXxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
# UPSTASH_REDIS_REST_TOKEN=

# Upstash Vector REST URL
# 取得先: https://console.upstash.com/
# UPSTASH_VECTOR_REST_URL=

# Upstash Vector REST Token
# UPSTASH_VECTOR_REST_TOKEN=

# ==================== システム設定（任意） ====================

# Codexホームディレクトリ（デフォルト: ~/.codex）
# 用途: 設定ファイル、認証情報、ログの保存先
# CODEX_HOME=

# Rustログレベル（デフォルト: info）
# 選択肢: error, warn, info, debug, trace
# 用途: デバッグ時に詳細ログを出力
RUST_LOG=info

# ==================== 開発・デバッグ用（任意） ====================

# デバッグモード（1で有効化）
# 用途: 詳細なデバッグ情報を出力
# DEBUG=

# ログの詳細レベル
# 用途: より詳細なログを出力
# VERBOSE=

# ==================== 使用例 ====================

# 【パターン1】最小構成（OpenAIのみ）:
# CODEX_API_KEY=sk-proj-XXXXXXXXXXXXXXXXXXXX

# 【パターン2】標準構成（GitHub連携込み）:
# CODEX_API_KEY=sk-proj-XXXXXXXXXXXXXXXXXXXX
# GITHUB_TOKEN=ghp_XXXXXXXXXXXXXXXXXXXX

# 【パターン3】フル機能構成（すべてのMCPサーバー有効化）:
# CODEX_API_KEY=sk-proj-XXXXXXXXXXXXXXXXXXXX
# OPENAI_API_KEY=sk-proj-XXXXXXXXXXXXXXXXXXXX
# GITHUB_TOKEN=ghp_XXXXXXXXXXXXXXXXXXXX
# GEMINI_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXX
# BRAVE_API_KEY=BSA_XXXXXXXXXXXXXXXXXXXX
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/XXX/XXX/XXX
# RUST_LOG=info

# ==================== 読み込み方法 ====================

# 【方法1】PowerShell（Windows）
# 現在のセッションに読み込み:
Get-Content .env | ForEach-Object {
    if ($_ -match '^([^#][^=]+)=(.*)$') {
        [System.Environment]::SetEnvironmentVariable($matches[1].Trim(), $matches[2].Trim(), "Process")
    }
}

# 【方法2】Bash/Zsh（Linux/macOS）
# 現在のシェルに読み込み:
set -a
source .env
set +a

# 【方法3】専用スクリプト使用（推奨）
# PowerShell: .\zapabob\scripts\load-env.ps1
# Bash: source zapabob/scripts/load-env.sh

# 【方法4】自動読み込みツール
# - direnv: https://direnv.net/
#   .envrc ファイルに「dotenv」と記述するだけで自動読み込み
# - dotenv (Node.js): https://www.npmjs.com/package/dotenv
#   require('dotenv').config() で読み込み

# ==================== セキュリティチェックリスト ====================

# ✅ .envファイルを.gitignoreに追加済み（51行目: .env*）
# ✅ パーミッション設定: chmod 600 .env（Linux/macOS）
# ✅ APIキーは定期的にローテーション（推奨: 90日ごと）
# ✅ 使用していないAPIキーは即座に削除・無効化
# ✅ .envファイルを公開リポジトリにコミットしない
# ✅ コードレビュー時にAPIキーが含まれていないか確認
# ✅ APIキーの先頭10文字のみログに出力（マスキング）
# ✅ 環境変数を平文でファイルに保存しない

# ==================== トラブルシューティング ====================

# 【問題1】環境変数が読み込まれない
# 解決策: PowerShell/シェルを再起動、または手動で環境変数を設定

# 【問題2】CODEX_API_KEYとOPENAI_API_KEYの両方が設定されている
# 動作: CODEX_API_KEYが優先されます（正常動作）

# 【問題3】MCP Serverが環境変数を読み込まない
# 解決策: config.tomlのenv.XXX設定を確認
# 例: env.OPENAI_API_KEY = "${OPENAI_API_KEY}"

# 【問題4】APIキーの形式が正しいか分からない
# 確認方法: zapabob\scripts\setup-env-vars.ps1 -ShowCurrent

# ==================== 関連ドキュメント ====================

# - 詳細ガイド: _docs/2025-11-02_環境変数APIキー設定ガイド.md
# - 実装レポート: _docs/2025-11-02_環境変数APIキー管理実装完了.md
# - セキュリティ規約: .cursorrules - Security Best Practices
# - 設定スクリプト: zapabob/scripts/setup-env-vars.ps1
# - 読み込みスクリプト: zapabob/scripts/load-env.ps1

# ==================== 外部リンク ====================

# - OpenAI API Keys: https://platform.openai.com/api-keys
# - GitHub Personal Access Tokens: https://github.com/settings/tokens
# - Google AI Studio: https://aistudio.google.com/app/apikey
# - Brave Search API: https://brave.com/search/api/
# - Slack Webhooks: https://api.slack.com/messaging/webhooks
# - Upstash Console: https://console.upstash.com/

# ==================== 優先順位まとめ ====================

# APIキー読み込みの優先順位（高 → 低）:
#   1. 🥇 CODEX_API_KEY 環境変数
#   2. 🥈 ~/.codex/auth.json ファイル
#   3. 🥉 OPENAI_API_KEY 環境変数
#   4. 🏅 OAuth トークン（ChatGPT認証）

# Gemini APIキーの優先順位:
#   1. GEMINI_API_KEY
#   2. GOOGLE_AI_STUDIO_API_KEY

# ==================== 注意事項 ====================

# ⚠️ このファイルは公開されません（.gitignore設定済み）
# ⚠️ APIキーは絶対に他人と共有しない
# ⚠️ 流出が疑われる場合は即座に無効化して再生成
# ⚠️ CI/CDではシークレット管理機能を使用（環境変数直接設定は避ける）
# ⚠️ 本番環境ではシークレット管理サービスの使用を推奨
#     - AWS Secrets Manager
#     - Azure Key Vault
#     - Google Cloud Secret Manager
#     - HashiCorp Vault


