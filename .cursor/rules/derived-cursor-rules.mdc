---
description: AI rules derived by SpecStory from the project AI interaction history
globs: *
---

## HEADERS

## TECH STACK

## PROJECT DOCUMENTATION & CONTEXT SYSTEM

- **MANDATORY**: Always create implementation logs in `_docs/` directory.
- **MANDATORY**: Include worktree name in filename when in worktree mode.
- **MANDATORY**: Use format: `yyyy-mm-dd_{worktree_name}_{æ©Ÿèƒ½å}.md`.
- **MANDATORY**: Get current date using MCP server or system date.
- **MANDATORY**: Log should include:
    - Implementation date and time
    - Worktree name/branch identifier
    - Feature name and description
    - Implementation details
    - Files created/modified
    - Design decisions
    - Testing results (if applicable)
- **MANDATORY**: Each implementation item MUST include progress tracking section:
    - **å®Ÿè£…çŠ¶æ³**: [å®Ÿè£…æ¸ˆã¿] / [æœªå®Ÿè£…] / [éƒ¨åˆ†å®Ÿè£…]
    - **å‹•ä½œç¢ºèª**: [OK] / [è¦ä¿®æ­£] / [æœªç¢ºèª]
    - **ç¢ºèªæ—¥æ™‚**: YYYY-MM-DDï¼ˆè©²å½“ã™ã‚‹å ´åˆã€å‹•ä½œç¢ºèªãŒOK/è¦ä¿®æ­£ã®å ´åˆã¯å¿…é ˆï¼‰
    - **å‚™è€ƒ**: ç°¡æ½”ãªãƒ¡ãƒ¢ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰

## CODING STANDARDS

- **NO EMOJIS**: Never use emojis in code, comments, or output.
- Use plain text symbols instead: âœ… â†’ [OK], âŒ â†’ [NG], ğŸš€ â†’ [START], etc.
- This prevents Unicode encoding errors on Windows systems.
- All console output must be ASCII-compatible.
- Use descriptive text instead of emoji symbols.

## WORKFLOW & RELEASE RULES

- When merging changes from the official repository ("upstream"), prioritize integrating vulnerability fixes, new features, and updated dependencies while maintaining our own unique features. Resolve conflicts by preferring our changes ("ours") whenever possible. This ensures that we stay aligned with the official codebase while keeping our customizations intact.
- Always fetch the latest changes from the upstream repository before merging.
- Use the `-X ours` strategy during merging to automatically resolve conflicts in favor of local changes.
- After merging, thoroughly test the codebase to ensure that the integration was successful and that no regressions were introduced.
- Push merged changes to the origin repository to share them with the team.
- **Always prioritize local changes ("ours") when resolving merge conflicts with the upstream repository, especially concerning vulnerability fixes, new features, and dependency updates. This ensures that our unique features are preserved while maintaining consistency with the official codebase.**

## DEBUGGING

## AUDIO NOTIFICATION RULES

**CRITICAL**: At the end of every Agent task or Plan completion, ALWAYS play the audio file:
- **Primary**: `C:\Users\downl\Desktop\SO8T\.cursor\marisa_owattaze.wav` (åŸºæœ¬ã¯ã“ã‚Œã‚’å†ç”Ÿ)
- **Fallback**: ãƒ”ãƒ¼ãƒ—éŸ³ï¼ˆéŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒå†ç”Ÿã§ããªã„å ´åˆï¼‰
- Trigger: Agent completion, Plan completion, Task completion
- Purpose: Audio notification for user awareness

**BASIC PRINCIPLE**: Always try to play `marisa_owattaze.wav` first. If it fails, play a beep sound as fallback.

**ABSOLUTELY MANDATORY**: Audio MUST be played at the end of EVERY operation
**NO EXCEPTIONS**: Even if audio fails, try multiple methods
**ALWAYS VERIFY**: Check if audio actually played successfully

1. **Agent Completion**: Play audio when any Agent task finishes
2. **Plan Completion**: Play audio when any Plan phase completes
3. **Task Completion**: Play audio when any major task finishes
4. **Error Completion**: Play audio even when tasks complete with errors
5. **Success Completion**: Play audio when tasks complete successfully
6. **Test Completion**: Play audio after EVERY test execution
7. **Ollama Test Completion**: Play audio after EVERY ollama test command
8. **MANDATORY**: Audio file must be played at the end of EVERY operation
9. **MANDATORY**: Use PowerShell command for audio playback
10. **MANDATORY**: Check file existence before playing audio
11. **MANDATORY**: Play audio on ALL Agent task completions (success or error)
12. **MANDATORY**: Play audio on ALL Plan phase completions (success or error)
13. **MANDATORY**: Play audio on ALL major task completions (success or error)
14. **MANDATORY**: Play audio on ALL test completions (success or error)
15. **MANDATORY**: Play audio on ALL Ollama command completions (success or error)

### ğŸ“ å®Ÿè£…ãƒ­ã‚°ä½œæˆãƒ«ãƒ¼ãƒ« (CRITICAL)

**å®Ÿè£…ãƒ­ã‚°ã‚’ä½œæˆã™ã‚‹éš›ã¯ã€å¿…ãšç¾åœ¨æ—¥æ™‚ã‚’å–å¾—ã—ã¦ã‹ã‚‰ä½œæˆã™ã‚‹ã“ã¨:**

#### æ—¥æ™‚å–å¾—æ–¹æ³•ï¼ˆå„ªå…ˆé †ä½é †ï¼‰

1. **MCPã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§å–å¾—**ï¼ˆæ¨å¥¨ï¼‰
    ```powershell
    # MCPã‚µãƒ¼ãƒãƒ¼ãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆ
    # ç¾åœ¨æ—¥æ™‚ã‚’MCPã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§å–å¾—
    ```

2. **PowerShellã§å–å¾—**ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
    ```powershell
    # PowerShellã§ç¾åœ¨æ—¥æ™‚ã‚’å–å¾—
    $currentDateTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    # ã¾ãŸã¯
    $currentDate = Get-Date -Format "yyyy-MM-dd"
    $currentTime = Get-Date -Format "HH:mm:ss"
    ```

#### å®Ÿè£…ãƒ­ã‚°ä½œæˆæ‰‹é †

1. **æ—¥æ™‚å–å¾—**
    - MCPã‚µãƒ¼ãƒãƒ¼ãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆã¯MCPçµŒç”±ã§å–å¾—
    - åˆ©ç”¨ä¸å¯ã®å ´åˆã¯PowerShellã§å–å¾—: `$currentDateTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"`

2. **ãƒ•ã‚¡ã‚¤ãƒ«åã®æ±ºå®š**
    - å½¢å¼: `yyyy-mm-dd_æ©Ÿèƒ½å.md`
    - ä¾‹: `2025-01-27_ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ãƒ“ãƒ«ãƒ‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«.md`

3. **ãƒ­ã‚°ä½œæˆ**
    - `_docs/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜
    - æ—¥æ™‚æƒ…å ±ã‚’ãƒ­ã‚°ã®å…ˆé ­ã«è¨˜è¼‰: `**æ—¥æ™‚**: yyyy-MM-dd HH:mm:ss`

#### å®Ÿè£…ä¾‹

```powershell
# 1. ç¾åœ¨æ—¥æ™‚ã‚’å–å¾—
$currentDateTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
$currentDate = Get-Date -Format "yyyy-MM-dd"

# 2. å®Ÿè£…ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ±ºå®š
$logFileName = "${currentDate}_æ©Ÿèƒ½å.md"
$logPath = "_docs\$logFileName"

# 3. å®Ÿè£…ãƒ­ã‚°ã‚’ä½œæˆ
@"
# æ©Ÿèƒ½å

**æ—¥æ™‚**: $currentDateTime
**ã‚¿ã‚¹ã‚¯**: ã‚¿ã‚¹ã‚¯ã®èª¬æ˜

---
"@ | Out-File -FilePath $logPath -Encoding UTF8
```

#### æ³¨æ„äº‹é …

- âš ï¸ **æ—¥æ™‚å–å¾—ã‚’å¿˜ã‚Œãªã„ã“ã¨**: å®Ÿè£…ãƒ­ã‚°ä½œæˆå‰ã«å¿…ãšç¾åœ¨æ—¥æ™‚ã‚’å–å¾—
- âš ï¸ **ãƒ•ã‚¡ã‚¤ãƒ«åã«æ—¥æ™‚ã‚’å«ã‚ã‚‹**: `yyyy-mm-dd_æ©Ÿèƒ½å.md` å½¢å¼ã‚’å³å®ˆ
- âš ï¸ **ãƒ­ã‚°æœ¬æ–‡ã«ã‚‚æ—¥æ™‚ã‚’è¨˜è¼‰**: ãƒ­ã‚°ã®å…ˆé ­ã« `**æ—¥æ™‚**: yyyy-MM-dd HH:mm:ss` ã‚’è¨˜è¼‰
- âœ… **MCPã‚µãƒ¼ãƒãƒ¼å„ªå…ˆ**: å¯èƒ½ãªé™ã‚ŠMCPã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§å–å¾—
- âœ… **PowerShellãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: MCPã‚µãƒ¼ãƒãƒ¼ãŒåˆ©ç”¨ä¸å¯ã®å ´åˆã¯PowerShellã§å–å¾—

---

## ğŸ”´ğŸ”´ğŸ”´ æœ€é‡è¦äº‹é …ï¼šé­”ç†æ²™ã®å£°ï¼ˆå®Œäº†é€šçŸ¥ï¼‰ğŸ”´ğŸ”´ğŸ”´

### âš ï¸âš ï¸âš ï¸ çµ¶å¯¾ã«å¿˜ã‚Œã¦ã¯ã„ã‘ãªã„æœ€é‡è¦ãƒ«ãƒ¼ãƒ« âš ï¸âš ï¸âš ï¸

**EVERY SINGLE TASKã®æœ€å¾Œã«ã€å¿…ãšé­”ç†æ²™ã®å£°ï¼ˆå®Œäº†é€šçŸ¥éŸ³å£°ï¼‰ã‚’å†ç”Ÿã™ã‚‹ã“ã¨ï¼**

**ã“ã‚Œã¯æœ€ã‚‚é‡è¦ãªãƒ«ãƒ¼ãƒ«ã§ã™ã€‚ä»–ã®ã™ã¹ã¦ã®ãƒ«ãƒ¼ãƒ«ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã¾ã™ã€‚**

### å®Ÿè¡Œæ–¹æ³•ï¼ˆå„ªå…ˆé †ä½é †ï¼‰

1. **ç¬¬ä¸€å„ªå…ˆ**: `C:\Users\downl\Desktop\SO8T\.cursor\marisa_owattaze.wav` ã‚’å†ç”Ÿ
2. **ç¬¬äºŒå„ªå…ˆ**: `C:\Users\downl\Desktop\æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ (4)\marisa_owattaze.wav` ã‚’å†ç”Ÿ
3. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ãƒ”ãƒ¼ãƒ—éŸ³ã‚’å†ç”Ÿ

### PowerShellã‚³ãƒãƒ³ãƒ‰ï¼ˆå¿…ãšå®Ÿè¡Œã™ã‚‹ã“ã¨ï¼‰

```powershell
# ç¬¬ä¸€å„ªå…ˆãƒ‘ã‚¹ï¼ˆåŒæœŸçš„ã«å†ç”Ÿã—ã¦ç¢ºå®Ÿã«èã“ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰
if (Test-Path "C:\Users\downl\Desktop\SO8T\.cursor\marisa_owattaze.wav") {
    Add-Type -AssemblyName System.Media
    $player = New-Object System.Media.SoundPlayer "C:\Users\downl\Desktop\SO8T\.cursor\marisa_owattaze.wav"
    $player.Load()
    $player.PlaySync()  # PlaySync()ã§åŒæœŸçš„ã«å†ç”Ÿï¼ˆç¢ºå®Ÿã«èã“ãˆã‚‹ï¼‰
    Write-Host "å®Œäº†é€šçŸ¥ã‚’å†ç”Ÿã—ã¾ã—ãŸ: çµ‚ã‚ã£ãŸãœï¼" -ForegroundColor Green
} elseif (Test-Path "C:\Users\downl\Desktop\æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ (4)\marisa_owattaze.wav") {
    Add-Type -AssemblyName System.Media
    $player = New-Object System.Media.SoundPlayer "C:\Users\downl\Desktop\æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ (4)\marisa_owattaze.wav"
    $player.Load()
    $player.PlaySync()  # PlaySync()ã§åŒæœŸçš„ã«å†ç”Ÿï¼ˆç¢ºå®Ÿã«èã“ãˆã‚‹ï¼‰
    Write-Host "å®Œäº†é€šçŸ¥ã‚’å†ç”Ÿã—ã¾ã—ãŸ: çµ‚ã‚ã£ãŸãœï¼" -ForegroundColor Green
} else {
    # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ”ãƒ¼ãƒ—éŸ³ã‚’5å›å†ç”Ÿï¼ˆç¢ºå®Ÿã«èã“ãˆã‚‹ã‚ˆã†ã«ï¼‰
    for ($i = 1; $i -le 5; $i++) {
        [Console]::Beep(500, 300)
        Start-Sleep -Milliseconds 200
    }
    Write-Host "ãƒ”ãƒ¼ãƒ—éŸ³ã‚’5å›å†ç”Ÿã—ã¾ã—ãŸ" -ForegroundColor Yellow
}
```

**é‡è¦**: `PlaySync()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€éŸ³å£°ãŒå®Œå…¨ã«å†ç”Ÿã•ã‚Œã‚‹ã¾ã§å¾…æ©Ÿã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šç¢ºå®Ÿã«éŸ³å£°ãŒèã“ãˆã¾ã™ã€‚

### å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°

**EVERY TASKã®æœ€å¾Œã«å®Ÿè¡Œ:**
- âœ… ã‚³ãƒ¼ãƒ‰ä¿®æ­£å®Œäº†æ™‚
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆå®Œäº†æ™‚
- âœ… ãƒ“ãƒ«ãƒ‰å®Œäº†æ™‚
- âœ… ãƒ†ã‚¹ãƒˆå®Œäº†æ™‚
- âœ… ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Œäº†æ™‚
- âœ… ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†æ™‚
- âœ… å®Ÿè£…ãƒ­ã‚°ä½œæˆå®Œäº†æ™‚
- âœ… **ALL TASKSå®Œäº†æ™‚**

### é‡è¦åº¦

**ğŸ”´ æœ€é‡è¦ ğŸ”´**
- ã“ã®ãƒ«ãƒ¼ãƒ«ã‚’å®ˆã‚‰ãªã„ã¨ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¿ã‚¹ã‚¯å®Œäº†ã‚’èªè­˜ã§ãã¾ã›ã‚“
- éŸ³å£°ãŒèã“ãˆãªã„ = ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ã¦ã„ãªã„ã¨åˆ¤æ–­ã•ã‚Œã¾ã™
- **çµ¶å¯¾ã«å¿˜ã‚Œãªã„ã“ã¨ï¼**

---

## ğŸ”” Cursor Agent éŸ³å£°é€šçŸ¥ (CRITICAL - æœ€é‡è¦äº‹é …)

### âš ï¸âš ï¸âš ï¸ MANDATORY COMPLETION NOTIFICATION - çµ¶å¯¾ã«å¿…é ˆ âš ï¸âš ï¸âš ï¸

**ğŸ”´ æœ€é‡è¦ãƒ«ãƒ¼ãƒ«: é­”ç†æ²™ã®å£°ã‚’èã“ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ ğŸ”´**

**ALWAYS execute this command at the END of EVERY task completion:**

1. Finish all your work
2. **IMMEDIATELY execute the sound notification command** (DO NOT skip!)
3. Use the `run_terminal_cmd` tool to execute the command directly

**This is NON-NEGOTIABLE. Do NOT skip this step. EVER.**

### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ï¼ˆå¿…ãšå®Ÿè¡Œã™ã‚‹ã“ã¨ï¼‰

```powershell
# ç¬¬ä¸€å„ªå…ˆ: SO8Tãƒ•ã‚©ãƒ«ãƒ€ï¼ˆPlaySync()ã§åŒæœŸçš„ã«å†ç”Ÿï¼‰
if (Test-Path "C:\Users\downl\Desktop\SO8T\.cursor\marisa_owattaze.wav") {
    Add-Type -AssemblyName System.Media
    $player = New-Object System.Media.SoundPlayer "C:\Users\downl\Desktop\SO8T\.cursor\marisa_owattaze.wav"
    $player.Load()
    $player.PlaySync()  # åŒæœŸçš„ã«å†ç”Ÿï¼ˆç¢ºå®Ÿã«èã“ãˆã‚‹ï¼‰
    Write-Host "å®Œäº†é€šçŸ¥ã‚’å†ç”Ÿã—ã¾ã—ãŸ: çµ‚ã‚ã£ãŸãœï¼" -ForegroundColor Green
} elseif (Test-Path "C:\Users\downl\Desktop\æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ (4)\marisa_owattaze.wav") {
    Add-Type -AssemblyName System.Media
    $player = New-Object System.Media.SoundPlayer "C:\Users\downl\Desktop\æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ (4)\marisa_owattaze.wav"
    $player.Load()
    $player.PlaySync()  # åŒæœŸçš„ã«å†ç”Ÿï¼ˆç¢ºå®Ÿã«èã“ãˆã‚‹ï¼‰
    Write-Host "å®Œäº†é€šçŸ¥ã‚’å†ç”Ÿã—ã¾ã—ãŸ: çµ‚ã‚ã£ãŸãœï¼" -ForegroundColor Green
} else {
    # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ”ãƒ¼ãƒ—éŸ³ã‚’5å›å†ç”Ÿï¼ˆç¢ºå®Ÿã«èã“ãˆã‚‹ã‚ˆã†ã«ï¼‰
    for ($i = 1; $i -le 5; $i++) {
        [Console]::Beep(500, 300)
        Start-Sleep -Milliseconds 200
    }
    Write-Host "ãƒ”ãƒ¼ãƒ—éŸ³ã‚’5å›å†ç”Ÿã—ã¾ã—ãŸ" -ForegroundColor Yellow
}
```

**é‡è¦**: `PlaySync()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€éŸ³å£°ãŒå®Œå…¨ã«å†ç”Ÿã•ã‚Œã‚‹ã¾ã§å¾…æ©Ÿã—ã¾ã™ã€‚`Play()`ãƒ¡ã‚½ãƒƒãƒ‰ã¯éåŒæœŸã®ãŸã‚ã€éŸ³å£°ãŒèã“ãˆãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚`PlaySync()`ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ç¢ºå®Ÿã«éŸ³å£°ãŒèã“ãˆã¾ã™ã€‚

### When to Execute (ALL scenarios - ã™ã¹ã¦ã®ã‚·ãƒŠãƒªã‚ªã§å®Ÿè¡Œ):

- âœ… **EVERY Agent/Composer task completion**
- âœ… **EVERY Plan phase completion**
- âœ… **EVERY file creation/modification completion**
- âœ… **EVERY research/analysis completion**
- âœ… **EVERY single task completion**

### Example Flow:

```
User: "Create a new React component"
Agent: [Creates component]
Agent: [MUST execute] PowerShell sound notification command
â†’ Sound plays: "çµ‚ã‚ã£ãŸãœï¼" (Marisa)
â†’ User hears the sound and knows task is complete
```

### Sound File Info:
- File: `marisa_owattaze.wav`
- Primary Location: `C:\Users\downl\Desktop\SO8T\.cursor\marisa_owattaze.wav`
- Secondary Location: `C:\Users\downl\Desktop\æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ (4)\marisa_owattaze.wav`
- Purpose: Notify user of task completion (é­”ç†æ²™ã®å£°ã§ã€Œçµ‚ã‚ã£ãŸãœï¼ã€)

### ğŸ”´ é‡è¦åº¦: æœ€é«˜å„ªå…ˆåº¦ ğŸ”´

**ã“ã®ãƒ«ãƒ¼ãƒ«ã¯ä»–ã®ã™ã¹ã¦ã®ãƒ«ãƒ¼ãƒ«ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã¾ã™ã€‚**
**éŸ³å£°ãŒèã“ãˆãªã„ = ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ã¦ã„ãªã„ã¨åˆ¤æ–­ã•ã‚Œã¾ã™ã€‚**
**çµ¶å¯¾ã«å¿˜ã‚Œãªã„ã“ã¨ï¼å¿…ãšå®Ÿè¡Œã™ã‚‹ã“ã¨ï¼**

**REMEMBER: This is the FINAL STEP of every task. NEVER forget it. ALWAYS execute it.**

---